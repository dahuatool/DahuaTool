<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS"
	 crossorigin="anonymous">
	<style>
		body,
		html,
		main,
		form {
			height: 100%;
			font-size: 0.9em;
		}

    body {
      overflow-y:hidden;
    }

		main {
      padding:0px;
			padding-top: 5em;
		}

		#textarea {
			padding: 0px;
		}

		.form-control,
		.form-group,
    .form-group row {
			padding: 1px;
			margin: 0px;
		}

		#mainText {
			font-family: "Consolas", monospace;
			background-color: #EFF;
		}
    .navbar-light, .navbar-light a, navbar-brand {
      background-color: #FFF;
      color: #A90329 !important;
    }

	</style>
	<title>Dahua Tool</title>
</head>

<body onload="reset()">
	<nav class="navbar navbar-expand navbar-light fixed-top">
		<a class="navbar-brand" href="#"><img src="https://us.dahuasecurity.com/wp-content/uploads/2017/08/Dahua-LOGO_black_with_red_D.png" style="height:35px; margin:0"></a>

    
    <div>
      <ul class="navbar-nav mr-auto">
        <li class="nav-item active">
          <a class="nav-link" href="#" onclick="reset()">Reset <span class="sr-only">(current)</span></a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="dropdownWizard" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Your Name</a>
          <div class="dropdown-menu" aria-labelledby="dropdown01" id="dropdownNameList">
            <a class="dropdown-item "href="#">Alejandro G</a>
            <a class="dropdown-item "href="#">Angelica R</a>
            <a class="dropdown-item "href="#">Armando A</a>
            <a class="dropdown-item "href="#">Camila R</a>
            <a class="dropdown-item "href="#">Daniel C</a>
            <a class="dropdown-item "href="#">David Y</a>
            <a class="dropdown-item "href="#">Diego S</a>
            <a class="dropdown-item "href="#">Harold C</a>
            <a class="dropdown-item "href="#">Jhon R</a>
            <a class="dropdown-item "href="#">Juan S</a>
            <a class="dropdown-item "href="#">Luis P</a>
            <a class="dropdown-item "href="#">Mad P</a>
            <a class="dropdown-item "href="#">Manuel H</a>
            <a class="dropdown-item "href="#">Maria E</a>
            <a class="dropdown-item "href="#">Miguel P</a>
            <a class="dropdown-item "href="#">Santiago S</a>
            <a class="dropdown-item "href="#">Sebastian B</a>
            <a class="dropdown-item "href="#">Sebastian L</a>
            <a class="dropdown-item "href="#">Sonia M</a>
            <a class="dropdown-item "href="#">William S</a>
          </div>
        </li>        
      </ul>
    </div>  
  </nav>  
  <main role="main" class="container-fluid">
    <form id="dataForm">
    <div class="row" style="height:100%">
      <div id="textarea" class="col-sm-6">
        <textarea class="form-control form-control-sm" style="width:100%;height:100%;" id="mainText" rows="12"></textarea>
      </div>
      <div id="workarea" class="col-sm-6" style="height:65%;margin:0px;padding:0px;overflow-y:scroll;">
        <div class="form-group row">
          <label for="inputProblem" class="col-sm-2 col-form-label col-form-label-sm d-none d-sm-block">Problem</label>
          <div class="col-sm-10">
            <input type="text" class="form-control form-control-sm" id="inputProblem" placeholder="Problem" onInput="updateTextarea(this)">
          </div>
        </div>
        <div class="form-group row">
          <label for="inputModel" class="col-sm-2 col-form-label col-form-label-sm d-none d-sm-block">Model</label>
          <div class="col-sm-10 col-xs-12">
            <input type="text" class="form-control form-control-sm" id="inputModel" placeholder="Model Number" onInput="updateTextarea(this)">
          </div>
        </div>
        <div class="form-group row">
          <label for="inputSerial" class="col-sm-2 col-form-label col-form-label-sm d-none d-sm-block">Serial</label>
          <div class="col-sm-10 col-xs-12">
            <input type="text" class="form-control form-control-sm" id="inputSerial" placeholder="Serial Number" onInput="updateTextarea(this)">
          </div>
        </div>
        <div class="form-group row">
          <label for="inputDistributor" class="col-sm-2 col-form-label col-form-label-sm d-none d-sm-block">Distributor</label>
          <div class="col-sm-10 col-xs-12">
            <input type="text" class="form-control form-control-sm" id="inputDistributor" placeholder="Distributor" onInput="updateTextarea(this)">
          </div>
        </div>
        <div class="form-group row">
          <label for="inputFirmware" class="col-sm-2 col-form-label col-form-label-sm d-none d-sm-block">Firmware</label>
          <div class="col-sm-10 col-xs-12">
            <input type="text" class="form-control form-control-sm" id="inputFirmware" placeholder="Firmware" onInput="updateTextarea(this)">
          </div>
        </div>
        <div class="form-group row">
          <label for="selectFirst" class="col-sm-6 col-form-label col-form-label-sm">First time happenning?</label>
          <div class="col-sm-6">
            <select class="form-control form-control-sm mr-sm-2" id="selectFirst" placeholder="First time happening?" onChange="updateTextarea(this)">
              <option value="Yes">Yes</a>
              <option value="No">No</a>
            </select>
          </div>
        </div>
        <div class="form-group row">
          <label for="selectBefore" class="col-sm-4 col-form-label col-form-label-sm">Working before?</label>
          <div class="col-sm-8">
            <select class="form-control form-control-sm mr-sm-2" id="selectBefore" placeholder="Was it working before?" onChange="updateTextarea(this)">
              <option value="Yes">Yes</a>
              <option value="No">No</a>
              <option value="na" selected="selected">Not asked</a>
            </select>
          </div>
        </div>
        <div class="form-group row">
          <label for="inputFrequency" class="col-sm-2 col-form-label col-form-label-sm d-none d-sm-block">Frequency</label>
          <div class="col-sm-10 col-xs-12">
            <input type="text" class="form-control form-control-sm" id="inputFrequency" placeholder="Frequency and conditions" onInput="updateTextarea(this)">
          </div>
        </div>
        <div class="form-group row">
          <label for="inputError" class="col-sm-2 col-form-label col-form-label-sm d-none d-sm-block">Error</label>
          <div class="col-sm-10 col-xs-12">
            <input type="text" class="form-control form-control-sm" id="inputError" placeholder="Exact error if possible" onInput="updateTextarea(this)">
          </div>
        </div>
        <div class="form-group row">
          <label for="inputSoftware" class="col-sm-2 col-form-label col-form-label-sm d-none d-sm-block">Software</label>
          <div class="col-sm-10 col-xs-12">
            <input type="text" class="form-control form-control-sm" id="inputSoftware" placeholder="App/Software used" onInput="updateTextarea(this)">
          </div>
        </div>
        <div class="form-group row">
          <label for="selectWhere" class="col-sm-4 col-form-label col-form-label-sm">Happens where?</label>
          <div class="col-sm-4">
            <select class="form-control form-control-sm mr-sm-2" id="selectWhere" onChange="updateTextarea(this)">
              <option value="Monitor">Monitor</a>
              <option value="PC">PC</a>
              <option value="Phone">Phone</a>
              <option value="Tablet">Tablet</a>
              <option value="na" selected="selected">NA</a>
            </select>
          </div>
          <div class="col-sm-4">
            <select class="form-control form-control-sm mr-sm-2" id="selectWhere2" onChange="updateTextarea(this)">
                <option value="Monitor">Monitor</a>
                <option value="PC">PC</a>
                <option value="Phone">Phone</a>
                <option value="Tablet">Tablet</a>
                <option value="na" selected="selected">NA</a>
            </select>
          </div>
        </div>
        <div class="form-group row">
          <label for="selectCompatible" class="col-sm-6 col-form-label col-form-label-sm">Are units compatible?</label>
          <div class="col-sm-6">
            <select class="form-control form-control-sm mr-sm-2" id="selectCompatible" placeholder="Are the units compatible?" onInput="updateTextarea(this)">
              <option value="Yes">Yes</a>
              <option value="No">No</a>
              <option value="na" selected="selected">Not asked</a>
            </select>
          </div>
        </div>
        <div class="form-group row">
          <label for="inputSettings" class="col-sm-2 col-form-label col-form-label-sm d-none d-sm-block">Settings</label>
          <div class="col-sm-10 col-xs-12">
            <input type="text" class="form-control form-control-sm" id="inputSettings" placeholder="Settings verified" onInput="updateTextarea(this)">
          </div>
        </div>
<!--        
        <div class="form-group row">
          <label for="selectResolved" class="col-sm-6 col-form-label col-form-label-sm">Issue resolved?</label>
          <div class="col-sm-6">
            <select class="form-control form-control-sm mr-sm-2" id="selectResolved" placeholder="Issue resolved?" onChange="updateTextarea(this)">
              <option value="Yes" selected="selected">Yes</a>
              <option value="No">No</a>
            </select>
          </div>
        </div>
-->        
        <div class="form-group row">
          <label for="inputMissing" class="col-sm-4 col-form-label col-form-label-sm d-none d-sm-block">Missing steps</label>
          <div class="col-sm-8">
            <input type="text" class="form-control form-control-sm" id="inputMissing" placeholder="Missing steps"  onInput="updateTextarea(this)">
          </div>
        </div>
<!--
        <div class="form-group row">
          <div class="col-sm text-right">
            <button type="button" class="btn btn-primary btn-sm" accesskey="r" onclick="reset()">Reset</button>
          </div>        
-->
        </div>
      </div>
    </div>
    </form>
  </main>
    
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
  <script>
    // Global text from main textarea
    var mainText = document.getElementById("mainText");

    // Global string defaultHash, stores hash in its original form
    // fieldName:[templateText,isMandatory,value]
    const defaultHash = {      
      "inputProblem":["Problem",true,""],
      "inputModel":["Device Model",true,""],
      "inputSerial":["SN",true,""],
      "inputDistributor":["Distributor",true,""],
      "inputFirmware":["Firmware",false,""],
      "selectFirst":["\n- First time happening?",true,"Yes"],
      "selectBefore":["- Was it working before?",false,""],
      "inputFrequency":["- How often does it happen and under what conditions?",false,""],
      "inputError":["- Error",false,""],
      "inputSoftware":["- App/Software used",false,""],
      "selectWhere":["- Problem happens on (monitor, PC, phone, tablet, ipad)",false,""],
      "selectWhere2":["",false,""],
      "selectCompatible":["- Units are compatible)",false,""],
      "inputSettings":["- Settings were verified",false,""],
      "inputTx":["\nTroubleshooting",true,""],      
      "inputMissing":["\nMissing Steps",false ,""]
    };

    // Global string formHash, copies defaultHash
	  var formHash = JSON.parse(JSON.stringify(defaultHash));

    // Global current date in the required format
    var d = new Date();
    var currentDate = (d.getMonth() + 1) + "/" + d.getDate()  + "/" + d.getFullYear(); 	  

    var names = document.querySelectorAll("div#dropdownNameList > a")

    for (var i = 0; i < names.length; i++) {
      names[i].addEventListener('click', setCookie(names[i]);
    }
    
    function setCookie(element) {
      document.getElementById("dropdownWizard").innerHTML = element.innerHTML;
      updateTextarea("reset");
    }

    function getCookie(cname) {
      var name = cname + "=";
      var decodedCookie = decodeURIComponent(document.cookie);
      var ca = decodedCookie.split(';');
      for(var i = 0; i <ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
          c = c.substring(1);
        }

        if (c.indexOf(name) == 0) {
          return c.substring(name.length, c.length);
        }
      }
      return "";
    }
    
    // updateTextarea(): When a user types in the fields, textarea gets updated automatically
    function updateTextarea(element) {      
      var str = document.getElementById("dropdownWizard").innerHTML + " - " + currentDate + "\n\n";      
      // update hash with the new info, reset if needed
      if (element == "reset")
        formHash = JSON.parse(JSON.stringify(defaultHash));
      else
        formHash[element.id][2] = element.value;
    
      // create and outputstring from hash  
      for (var i in formHash) {
        // if its empty and optional
        if ((formHash[i][2] == "" || formHash[i][2] == "na" ) && !formHash[i][1]) {
          str += "";
        } else {
          //Special case for multiple selection fields, works but yeah
          if ((i == "selectWhere" || i == "selectWhere2" ) && formHash["selectWhere2"][2] != "na") {
            if (i == "selectWhere2") {
              ;
            } else {
              str += formHash[i][0] + ": " + formHash[i][2] + ", " + formHash["selectWhere2"][2] + "\n";
            }
          } else {        
            str += formHash[i][0] + ": " + formHash[i][2] + "\n";
	        }
        }
      }
      
      mainText.value = str;   
    }
    
    function reset() {
      document.getElementById("dataForm").reset();
      updateTextarea("reset");
    }

    // Shortcuts
    function doc_keyUp(e) {
      // alt+r 
      if (e.altKey && e.keyCode == 82) {          
          reset();
        }
      if (e.altKey && e.keyCode == 71) {          
          mainText.select();
          document.execCommand("copy");
        }
    }
    document.addEventListener('keyup', doc_keyUp, false);
    
    document.addEventListener('keyup', doc_keyUp, false);
  </script>
</body>
</html>